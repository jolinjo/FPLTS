<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>å·¥å» è£½ç¨‹ç‰©æµè¿½æº¯ç³»çµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* iOS é¢¨æ ¼è‡ªè¨‚æ¨£å¼ */
        * {
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(180deg, #f5f5f7 0%, #e8e8ed 100%);
            min-height: 100vh;
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        /* æ¯›ç»ç’ƒæ•ˆæœ */
        .glass {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }
        
        /* iOS å¤§å‹è† å›ŠæŒ‰éˆ• */
        .btn-capsule {
            border-radius: 9999px;
            padding: 16px 32px;
            font-size: 17px;
            font-weight: 600;
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .btn-capsule:active {
            transform: scale(0.98);
            opacity: 0.8;
        }
        
        /* iOS å¡ç‰‡ */
        .card {
            border-radius: 20px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        }
        
        /* iOS è¼¸å…¥æ¡† */
        .input-ios {
            border-radius: 12px;
            padding: 14px 16px;
            font-size: 17px;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        /* iOS è­¦ç¤ºè¦–çª— */
        .alert-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.2s;
        }
        
        .alert-dialog {
            background: white;
            border-radius: 20px;
            padding: 24px;
            max-width: 320px;
            width: 90%;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        /* æˆåŠŸå¡ç‰‡å‹•ç•« */
        .success-card {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        /* åº•éƒ¨å·¥ä½œè¡¨ */
        .bottom-sheet-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            z-index: 99;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-out, visibility 0.3s ease-out;
        }
        
        .bottom-sheet-overlay.open {
            opacity: 1;
            visibility: visible;
        }
        
        .bottom-sheet {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-radius: 24px 24px 0 0;
            box-shadow: 0 -4px 24px rgba(0, 0, 0, 0.15);
            z-index: 100;
            transform: translateY(100%);
            transition: transform 0.3s ease-out;
        }
        
        .bottom-sheet.open {
            transform: translateY(0);
        }
        
        /* è¿½æº¯çµæœé é¢ */
        .trace-page {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: white;
            z-index: 200;
            display: none;
            flex-direction: column;
            overflow-y: auto;
        }
        
        .trace-page.open {
            display: flex;
        }
        
        .trace-header {
            background: linear-gradient(180deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .trace-station-card {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #667eea;
        }
        
        .trace-station-header {
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 12px;
        }
        
        .trace-info-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .trace-info-row:last-child {
            border-bottom: none;
        }
        
        .trace-info-label {
            color: #6b7280;
            font-size: 14px;
        }
        
        .trace-info-value {
            color: #1f2937;
            font-size: 14px;
            font-weight: 500;
        }
        
        /* éš±è—æ»¾å‹•æ¢ä½†ä¿æŒæ»¾å‹•åŠŸèƒ½ */
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- è¨­å®šé é¢ï¼ˆå¼·åˆ¶ç™»å…¥ï¼‰ -->
    <div id="setupPage" class="min-h-screen flex items-center justify-center p-6 hidden">
        <div class="w-full max-w-md">
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-gray-900 mb-2">å·¥å» è£½ç¨‹ç‰©æµè¿½æº¯ç³»çµ±</h1>
                <p class="text-gray-600">è«‹å…ˆè¨­å®šæ‚¨çš„å·¥è™Ÿèˆ‡ç«™é»</p>
            </div>
            
            <div class="card glass p-6 mb-6">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">å·¥è™Ÿ</label>
                    <input 
                        type="text" 
                        id="operatorInput" 
                        class="input-ios w-full" 
                        placeholder="ä¾‹å¦‚ï¼šOP01"
                        autocomplete="off"
                    >
                </div>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">ç•¶å‰ç«™é»</label>
                    <select id="stationSelect" class="input-ios w-full">
                        <option value="">è«‹é¸æ“‡ç«™é»</option>
                    </select>
                </div>
                
                <button 
                    id="saveSetupBtn" 
                    class="btn-capsule w-full bg-blue-500 text-white"
                >
                    å„²å­˜è¨­å®š
                </button>
            </div>
        </div>
    </div>
    
    <!-- ä¸»åŠŸèƒ½é é¢ -->
    <div id="mainPage" class="min-h-screen p-4 pb-24 hidden">
        <!-- é ‚éƒ¨è³‡è¨Šåˆ— -->
        <div class="card glass p-4 mb-4">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm text-gray-600">æ“ä½œå“¡</p>
                    <p class="text-lg font-semibold text-gray-900" id="operatorDisplay">-</p>
                </div>
                <div class="text-right">
                    <p class="text-sm text-gray-600">ç•¶å‰ç«™é»</p>
                    <p class="text-lg font-semibold text-gray-900" id="stationDisplay">-</p>
                </div>
                <button 
                    id="changeSetupBtn" 
                    class="text-blue-500 text-sm font-medium"
                >
                    è®Šæ›´
                </button>
            </div>
        </div>
        
        <!-- åŠŸèƒ½æŒ‰éˆ•ç¶²æ ¼ -->
        <div class="grid grid-cols-2 gap-4 mb-4">
            <button 
                id="scanBtn" 
                class="card glass p-6 text-center btn-capsule bg-indigo-500 text-white col-span-2"
            >
                <div class="text-2xl mb-2">ğŸ“·</div>
                <div class="font-semibold">æƒææ¢ç¢¼ï¼ˆæ™ºèƒ½è­˜åˆ¥ï¼‰</div>
            </button>
            
            <button 
                id="inboundBtn" 
                class="card glass p-6 text-center btn-capsule bg-green-500 text-white"
            >
                <div class="text-2xl mb-2">ğŸ“¦</div>
                <div class="font-semibold">è²¨ç‰©é·å…¥</div>
            </button>
            
            <button 
                id="outboundBtn" 
                class="card glass p-6 text-center btn-capsule bg-blue-500 text-white"
            >
                <div class="text-2xl mb-2">ğŸš€</div>
                <div class="font-semibold">è²¨ç‰©é·å‡º</div>
            </button>
            
            <button 
                id="traceBtn" 
                class="card glass p-6 text-center btn-capsule bg-purple-500 text-white"
            >
                <div class="text-2xl mb-2">ğŸ”</div>
                <div class="font-semibold">è¿½æº¯æŸ¥è©¢</div>
            </button>
            
            <button 
                id="firstBtn" 
                class="card glass p-6 text-center btn-capsule bg-orange-500 text-white"
            >
                <div class="text-2xl mb-2">âœ¨</div>
                <div class="font-semibold">é¦–ç«™é·å‡º</div>
            </button>
        </div>
        
        <!-- æˆåŠŸè¨Šæ¯å¡ç‰‡ -->
        <div id="successCard" class="card glass p-4 mb-4 bg-green-50 border-2 border-green-200 hidden success-card">
            <div class="flex items-center">
                <div class="text-2xl mr-3">âœ…</div>
                <div class="flex-1">
                    <p class="font-semibold text-green-800" id="successMessage">æ“ä½œæˆåŠŸ</p>
                    <p class="text-sm text-green-600" id="successDetail"></p>
                </div>
            </div>
        </div>
        
        <!-- QR Code é¡¯ç¤ºå¡ç‰‡ -->
        <div id="qrcodeCard" class="card glass p-6 mb-4 hidden success-card">
            <div class="text-center">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">æ¢ç¢¼ QR Code</h3>
                <div id="qrcodeContainer" class="flex justify-center mb-4">
                    <!-- QR Code SVG å°‡åœ¨é€™è£¡é¡¯ç¤º -->
                </div>
                <button 
                    id="downloadQrcodeBtn" 
                    class="btn-capsule bg-blue-500 text-white"
                >
                    ğŸ“¥ ä¸‹è¼‰ QR Code
                </button>
            </div>
        </div>
    </div>
    
    <!-- åº•éƒ¨å·¥ä½œè¡¨ï¼ˆæƒæè¼¸å…¥ï¼‰ -->
    <!-- è¿½æº¯çµæœé é¢ -->
    <div id="tracePage" class="trace-page">
        <div class="trace-header">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-2xl font-bold" id="traceOrderTitle">è¿½æº¯æŸ¥è©¢</h2>
                <button id="closeTracePageBtn" class="text-white text-3xl font-light">Ã—</button>
            </div>
            <div class="text-sm opacity-90" id="traceSkuInfo"></div>
        </div>
        <div class="flex-1 p-4" id="traceContent">
            <!-- è¿½æº¯å…§å®¹å°‡åœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ -->
        </div>
    </div>
    
    <!-- åº•éƒ¨å·¥ä½œè¡¨èƒŒæ™¯é®ç½© -->
    <div id="bottomSheetOverlay" class="bottom-sheet-overlay"></div>
    
    <!-- åº•éƒ¨å·¥ä½œè¡¨ -->
    <div id="bottomSheet" class="bottom-sheet">
        <div class="p-6">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-xl font-semibold text-gray-900" id="sheetTitle">æƒææ¢ç¢¼</h3>
                <button id="closeSheetBtn" class="text-gray-500 text-2xl">Ã—</button>
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">æ¢ç¢¼</label>
                <input 
                    type="text" 
                    id="barcodeInput" 
                    class="input-ios w-full" 
                    placeholder="æƒææˆ–è¼¸å…¥æ¢ç¢¼"
                    autocomplete="off"
                    autofocus
                >
            </div>
            
            <!-- é·å‡ºå°ˆç”¨æ¬„ä½ -->
            <div id="outboundFields" class="hidden space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">å®¹å™¨</label>
                    <select id="containerSelect" class="input-ios w-full">
                        <option value="">è«‹é¸æ“‡å®¹å™¨</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ç®±è™Ÿ</label>
                    <input 
                        type="text" 
                        id="boxSeqInput" 
                        class="input-ios w-full" 
                        placeholder="ä¾‹å¦‚ï¼š01"
                        autocomplete="off"
                    >
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">è²¨æ…‹</label>
                    <select id="statusSelect" class="input-ios w-full">
                        <option value="G">G - è‰¯å“</option>
                        <option value="N">N - ä¸è‰¯</option>
                        <option value="S">S - ç‰¹æ¡</option>
                        <option value="R">R - è¿”å·¥</option>
                        <option value="E">E - éºå¤±</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">æ•¸é‡</label>
                    <input 
                        type="text" 
                        id="qtyInput" 
                        class="input-ios w-full" 
                        placeholder="ä¾‹å¦‚ï¼š0100"
                        autocomplete="off"
                    >
                </div>
            </div>
            
            <!-- é¦–ç«™é·å‡ºå°ˆç”¨æ¬„ä½ -->
            <div id="firstFields" class="hidden space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">å·¥å–®è™Ÿ</label>
                    <input 
                        type="text" 
                        id="orderInput" 
                        class="input-ios w-full" 
                        placeholder="ä¾‹å¦‚ï¼š251119AA"
                        autocomplete="off"
                        style="text-transform: uppercase;"
                    >
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ç”¢å“ç·š</label>
                    <select id="seriesSelect" class="input-ios w-full">
                        <option value="">è«‹é¸æ“‡ç”¢å“ç·š</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">æ©Ÿç¨®</label>
                    <select id="modelSelect" class="input-ios w-full">
                        <option value="">è«‹é¸æ“‡æ©Ÿç¨®</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">å®¹å™¨</label>
                    <select id="firstContainerSelect" class="input-ios w-full">
                        <option value="">è«‹é¸æ“‡å®¹å™¨</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ç®±è™Ÿ</label>
                    <input 
                        type="text" 
                        id="firstBoxSeqInput" 
                        class="input-ios w-full" 
                        placeholder="ä¾‹å¦‚ï¼š01"
                        autocomplete="off"
                    >
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">è²¨æ…‹</label>
                    <select id="firstStatusSelect" class="input-ios w-full">
                        <option value="G">G - è‰¯å“</option>
                        <option value="N">N - ä¸è‰¯</option>
                        <option value="S">S - ç‰¹æ¡</option>
                        <option value="R">R - è¿”å·¥</option>
                        <option value="E">E - éºå¤±</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">æ•¸é‡</label>
                    <input 
                        type="text" 
                        id="firstQtyInput" 
                        class="input-ios w-full" 
                        placeholder="ä¾‹å¦‚ï¼š0100"
                        autocomplete="off"
                    >
                </div>
            </div>
            
            <button 
                id="submitBtn" 
                class="btn-capsule w-full bg-blue-500 text-white mt-4"
            >
                æäº¤
            </button>
        </div>
    </div>
    
    <!-- è­¦ç¤ºè¦–çª— -->
    <div id="alertOverlay" class="alert-overlay hidden">
        <div class="alert-dialog">
            <div class="text-center">
                <div class="text-4xl mb-4" id="alertIcon">âš ï¸</div>
                <h3 class="text-xl font-semibold mb-2" id="alertTitle">éŒ¯èª¤</h3>
                <p class="text-gray-600 mb-6" id="alertMessage"></p>
                <button 
                    id="alertOkBtn" 
                    class="btn-capsule w-full bg-red-500 text-white"
                >
                    ç¢ºå®š
                </button>
            </div>
        </div>
    </div>
    
    <script src="/static/app.js"></script>
</body>
</html>

